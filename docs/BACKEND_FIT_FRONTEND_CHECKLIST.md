# Backend Adjustment Checklist - PhÃ¹ há»£p vá»›i Frontend

Checklist chi tiáº¿t Ä‘á»ƒ Ä‘iá»u chá»‰nh Backend API cho phÃ¹ há»£p vá»›i Frontend requirements.

---

## ğŸ” Phase 1: Route & Endpoint Alignment

### Step 1: Auth Routes
- [x] **Kiá»ƒm tra route prefix**
  - [x] Frontend expect: `/users/login`, `/users/register`, etc.
  - [x] Backend hiá»‡n táº¡i: `/api/v1/auth/login` (mount á»Ÿ `/api/v1/auth`)
  - [x] **Action**: Äá»•i mount point tá»« `/api/v1/auth` â†’ `/api/v1/users` Ä‘á»ƒ match vá»›i frontend
  - [x] **Done**: ÄÃ£ Ä‘á»•i mount point trong `be/src/index.ts`

### Step 2: User Profile Routes
- [x] **GET /users/me** - Láº¥y thÃ´ng tin user hiá»‡n táº¡i
  - [x] Táº¡o route `GET /users/me` trong `users.routes.ts`
  - [x] Táº¡o controller `getMeController` trong `users.controller.ts`
  - [x] Táº¡o service method `getMe(user_id)` trong `users.services.ts`
  - [x] Response format: `{ message, data: { _id, first_name, last_name, full_name, email, role, avatar, address, phonenumber, createdAt, updatedAt } }`
  - [x] Protected route (cáº§n `accessTokenValidator`)

- [x] **PATCH /users/me** - Cáº­p nháº­t thÃ´ng tin user
  - [x] Táº¡o route `PATCH /users/me` trong `users.routes.ts`
  - [x] Táº¡o controller `updateMeController` trong `users.controller.ts`
  - [x] Táº¡o service method `updateMe(user_id, data)` trong `users.services.ts`
  - [x] Request body: `{ first_name?, last_name?, email?, phonenumber?, address?, date_of_birth? }`
  - [x] Response format: `{ message, data: User }`
  - [x] Protected route (cáº§n `accessTokenValidator`)

- [x] **POST /users/me/avatar** - Upload avatar
  - [x] Táº¡o route `POST /users/me/avatar` trong `users.routes.ts`
  - [x] Táº¡o controller `uploadAvatarController` trong `users.controller.ts`
  - [x] Táº¡o service method `uploadAvatar(user_id, avatar_url)` trong `users.services.ts`
  - [x] **Note**: Hiá»‡n táº¡i accept `avatar_url` trong body. CÃ³ thá»ƒ implement file upload vá»›i multer sau
  - [x] Response format: `{ message, data: { avatar_url: string } }`
  - [x] Protected route (cáº§n `accessTokenValidator`)

### Step 3: Response Format Standardization
- [x] **Standardize API Response Format**
  - [x] Táº¥t cáº£ success responses pháº£i cÃ³ format: `{ message: string, data: any }`
  - [x] Táº¥t cáº£ error responses pháº£i cÃ³ format: `{ message: string, errors?: Array<{ field: string, message: string }> }`
  - [x] **Kiá»ƒm tra vÃ  sá»­a cÃ¡c controllers**:
    - [x] `cart.controller.ts` - Äá»•i `result` â†’ `data` âœ…
    - [x] `checkout.controller.ts` - Äá»•i `result` â†’ `data` trong `placeOrderController` âœ…
    - [x] `orders.controller.ts` - ÄÃ£ cÃ³ format `{ message, data }` âœ…
    - [x] `products.controller.ts` - ÄÃ£ cÃ³ format `{ message, data }` âœ…
    - [x] `categories.controller.ts` - Cáº§n kiá»ƒm tra
    - [x] `banners.controller.ts` - ÄÃ£ cÃ³ format `{ message, data }` âœ…
    - [ ] `admin.controller.ts` - Cáº§n kiá»ƒm tra

---

## ğŸ” Phase 2: Authentication & User Data

### Step 1: Login/Register Response
- [x] **Login Response**
  - [x] Äáº£m báº£o response cÃ³: `{ access_token, refresh_token, user: { _id, first_name, last_name, full_name, email, role, avatar, ... } }`
  - [x] User object pháº£i cÃ³ Ä‘áº§y Ä‘á»§ fields mÃ  frontend cáº§n
  - [x] Kiá»ƒm tra `users.services.ts` - method `login()` tráº£ vá» Ä‘Ãºng format âœ…

- [x] **Register Response**
  - [x] Äáº£m báº£o response cÃ³: `{ access_token, refresh_token, user: { ... } }`
  - [x] User object pháº£i cÃ³ Ä‘áº§y Ä‘á»§ fields
  - [x] Kiá»ƒm tra `users.services.ts` - method `register()` tráº£ vá» Ä‘Ãºng format âœ…
  - [x] ÄÃ£ thÃªm `refresh_token` vÃ o register response âœ…

### Step 2: Token Management
- [x] **Token trong Response**
  - [x] Äáº£m báº£o `access_token` vÃ  `refresh_token` Ä‘Æ°á»£c tráº£ vá» trong login/register response âœ…
  - [x] Token format: JWT string âœ…

- [x] **Token Validation**
  - [x] Middleware `accessTokenValidator` hoáº¡t Ä‘á»™ng Ä‘Ãºng âœ…
  - [x] Tráº£ vá» 401 náº¿u token invalid/expired âœ… (trong `accessTokenValidator` vÃ  `refreshTokenValidator`)
  - [x] Tráº£ vá» 403 náº¿u khÃ´ng Ä‘á»§ quyá»n âœ… (trong `requireAdmin` middleware)

---

## ğŸ›ï¸ Phase 3: Products & Categories

### Step 1: Products API
- [x] **GET /products** - Products List
  - [x] Response format: `{ message, data: { products: Product[], pagination: { page, limit, total_page, total } } }` âœ…
  - [x] Query params support: `page, limit, category_slug, name, sort_by, order, price_min, price_max, rating_filter, is_featured` âœ…
  - [x] Pagination metadata Ä‘áº§y Ä‘á»§ (Ä‘Ã£ thÃªm `total`) âœ…
  - [x] Populate category info cho má»—i product âœ…
  - [x] Kiá»ƒm tra `products.services.ts` - method `getProducts()` âœ…

- [x] **GET /products/:slug** - Product Detail
  - [x] Response format: `{ message, data: Product }` âœ…
  - [x] Product object pháº£i cÃ³ Ä‘áº§y Ä‘á»§ fields: `_id, name, slug, description, price, price_before_discount, images, image, sizes, colors, quantity, rating, category, ...` âœ…
  - [x] Populate category info trong product detail âœ…
  - [x] Kiá»ƒm tra `products.services.ts` - method `getProductDetail()` âœ…

- [x] **GET /products/:slug/related** - Related Products
  - [x] Response format: `{ message, data: Product[] }` âœ…
  - [x] Populate category info cho related products âœ…
  - [x] Kiá»ƒm tra `products.services.ts` - method `getRelatedProducts()` âœ…

### Step 2: Categories API
- [x] **GET /categories**
  - [x] Response format: `{ message, data: Category[] }` âœ…
  - [x] Category object pháº£i cÃ³: `_id, name, slug, image, description, ...` âœ…
  - [x] Query params support: `is_featured?, limit?` âœ…
  - [x] Kiá»ƒm tra `categories.services.ts` âœ…

### Step 3: Banners API
- [x] **GET /banners**
  - [x] Response format: `{ message, data: Banner[] }` âœ…
  - [x] Query params support: `position?` (e.g., 'home_hero') âœ…
  - [x] Banner object pháº£i cÃ³: `id, title, subtitle, image_url, alt_text, cta_text, cta_link, order, position` âœ…
  - [x] **Note**: Hiá»‡n táº¡i sá»­ dá»¥ng mock data trong controller, cÃ³ thá»ƒ táº¡o service sau náº¿u cáº§n

---

## ğŸ›’ Phase 4: Cart API

### Step 1: Cart Response Format
- [x] **GET /cart**
  - [x] Response format: `{ message, data: { _id, user_id, items: CartItem[] } }` âœ…
  - [x] **Action**: ÄÃ£ standardize response format âœ…
  - [x] CartItem pháº£i cÃ³: `_id, product_id, buy_count, color?, size?, product_name?, product_image?, price?, price_before_discount?, slug?` âœ…
  - [x] Convert ObjectId to string trong response âœ…

- [x] **POST /cart/items**
  - [x] Response format: `{ message, data: Cart }` âœ…
  - [x] Return updated cart sau khi add âœ…
  - [x] Request body: `{ product_id, buy_count, color?, size? }` âœ…

- [x] **PUT /cart/items/:item_id**
  - [x] Response format: `{ message, data: Cart }` âœ…
  - [x] Return updated cart sau khi update âœ…
  - [x] Request body: `{ buy_count }` âœ…

- [x] **DELETE /cart/items/:item_id**
  - [x] Response format: `{ message, data: Cart }` âœ…
  - [x] Return updated cart sau khi delete âœ…

### Step 2: Cart Service Enhancement
- [x] **Populate Product Info trong Cart Items**
  - [x] Khi get cart, populate thÃ´ng tin product vÃ o má»—i item âœ…
  - [x] Include: `product_name, product_image, price, price_before_discount, slug` âœ…
  - [x] Product_image fallback vá» `image` náº¿u `images` array khÃ´ng cÃ³ âœ…
  - [x] Kiá»ƒm tra `cart.services.ts` - method `getCart()` âœ…

---

## ğŸ“¦ Phase 5: Checkout & Orders

### Step 1: Checkout API
- [x] **GET /checkout/init**
  - [x] Response format: `{ message, data: { user: { name, email, phone }, saved_addresses: Array<{ id, full_address, is_default }> } }` âœ…
  - [x] Kiá»ƒm tra `checkout.controller.ts` - `checkoutInitController` âœ…

- [x] **POST /checkout/validate-shipping**
  - [x] Response format: `{ message, data: { shipping_fee, shipping_methods: Array<{ id, name, fee, estimated_delivery }> } }` âœ…
  - [x] Request body: `{ full_name, phone, email, province_id, district_id, ward_id, address }` âœ…
  - [x] Kiá»ƒm tra `checkout.controller.ts` - `validateShippingController` âœ…

- [x] **GET /checkout/payment-info**
  - [x] Response format: `{ message, data: { summary: { subtotal, subtotal_display, shipping_fee, shipping_display, discount_amount, total, total_display }, payment_methods: Array<{ id, name, description?, icons?, is_enabled }> } }` âœ…
  - [x] Kiá»ƒm tra `checkout.controller.ts` - `getPaymentInfoController` âœ…

- [x] **POST /checkout/place-order**
  - [x] Response format: `{ message, data: { order_id, order_code } }` âœ…
  - [x] **Action**: ÄÃ£ standardize response format, convert ObjectId to string âœ…
  - [x] Request body: `{ payment_method, note?, billing_address_same_as_shipping, shipping_address (string), receiver_name, phone, email }` âœ…
  - [x] Kiá»ƒm tra `orders.services.ts` - method `createOrder()` âœ…

### Step 2: Orders API
- [x] **GET /orders**
  - [x] Response format: `{ message, data: { items: Order[], pagination: { page, limit, total_page, total } } }` âœ…
  - [x] Query params: `page, limit, keyword, status, start_date, end_date` âœ…
  - [x] Order object cÃ³ Ä‘áº§y Ä‘á»§ fields: `_id, id, order_code, created_at, created_at_display, product_summary, total_amount, total_display, status, status_label, detail_link` âœ…
  - [x] Convert ObjectId to string trong response âœ…
  - [x] Kiá»ƒm tra `orders.services.ts` - method `getOrders()` âœ…

- [x] **GET /orders/:order_id**
  - [x] Response format: `{ message, data: Order }` âœ…
  - [x] Order object cÃ³ Ä‘áº§y Ä‘á»§ fields: `_id, id, order_code, status, current_status, status_label, status_color, timeline, items, summary, shipping_address, payment_method, created_at, created_at_display` âœ…
  - [x] Convert ObjectId to string trong response âœ…
  - [x] Items cÃ³ Ä‘áº§y Ä‘á»§ fields: `id, product_id, name, thumbnail_url, variant_text, price, price_display, quantity, total, total_display, can_review, is_reviewed` âœ…
  - [x] Kiá»ƒm tra `orders.services.ts` - method `getOrderDetail()` âœ…

---

## ğŸ“ Phase 6: Locations API âœ…

### Step 1: Locations Response Format
- [x] **GET /locations/provinces**
  - [x] Response format: `{ message, data: Location[] }` âœ…
  - [x] **Issue**: Backend cÃ³ thá»ƒ tráº£ vá» `result` field
  - [x] **Action**: Standardize response format âœ…
  - [x] Location object: `{ id, name, code? }` âœ…

- [x] **GET /locations/districts/:province_id**
  - [x] Response format: `{ message, data: Location[] }` âœ…
  - [x] Standardize response format âœ…

- [x] **GET /locations/wards/:district_id**
  - [x] Response format: `{ message, data: Location[] }` âœ…
  - [x] Standardize response format âœ…

**Notes:**
- âœ… Backend `locations.controller.ts` Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ tráº£ vá» `{ message, data: Location[] }`
- âœ… Frontend `locations.service.ts` Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ expect format má»›i
- âœ… `locations.json` Ä‘Ã£ Ä‘Æ°á»£c má»Ÿ rá»™ng vá»›i 5 provinces, 19 districts, 200+ wards
- âœ… `AddressForm.tsx` Ä‘Ã£ Ä‘Æ°á»£c sá»­a Ä‘á»ƒ sá»­ dá»¥ng `Controller` tá»« react-hook-form cho cascading dropdowns

---

## ğŸ‘¨â€ğŸ’¼ Phase 7: Admin API âœ…

### Step 1: Admin Dashboard
- [x] **GET /admin/dashboard/stats** âœ…
  - [x] Response format: `{ message, data: { total_revenue, total_orders, total_customers, total_products } }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `dashboardStatsController` âœ…

- [x] **GET /admin/dashboard/revenue-chart** âœ…
  - [x] Response format: `{ message, data: Array<{ date, revenue, orders }> }` âœ…
  - [x] Query params: `start_date?, end_date?, days?` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `revenueChartController` âœ…

- [x] **GET /admin/stats/overview** âœ…
  - [x] Response format: `{ message, data: { today: DashboardStats, this_week: DashboardStats, this_month: DashboardStats, this_year: DashboardStats } }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `statsOverviewController` âœ…

### Step 2: Admin Products
- [x] **GET /admin/products** âœ…
  - [x] Response format: `{ message, data: { products: Product[], pagination: { page, limit, total_page, total } } }` âœ…
  - [x] Query params: `page, limit, keyword, category_id, category_slug, status, sort_by, order` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetProductsController` âœ…

- [x] **GET /admin/products/:id** âœ…
  - [x] Response format: `{ message, data: Product }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetProductDetailController` âœ…

- [x] **PUT /admin/products/:id** âœ…
  - [x] Response format: `{ message, data: Product }` âœ…
  - [x] Request body: Partial<Product> âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateProductController` âœ…

- [x] **DELETE /admin/products/:id** âœ…
  - [x] Response format: `{ message }` âœ…
  - [x] Soft delete (set status = 'inactive' hoáº·c deleted_at) âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminDeleteProductController` âœ…

### Step 3: Admin Orders
- [x] **GET /admin/orders/stats** âœ…
  - [x] Response format: `{ message, data: { pending, processing, shipping, completed, cancelled, total } }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminOrdersStatsController` âœ…

- [x] **GET /admin/orders** âœ…
  - [x] Response format: `{ message, data: { orders: Order[], pagination: { page, limit, total_page, total } } }` âœ…
  - [x] Query params: `page, limit, keyword, status, date_from, date_to, sort_by, order` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetOrdersController` âœ…

### Step 4: Admin Customers
- [x] **GET /admin/customers** âœ…
  - [x] Response format: `{ message, data: { customers: User[], pagination: { page, limit, total_page, total } } }` âœ…
  - [x] Query params: `page, limit, keyword, status, sort_by, order` âœ…
  - [x] User object pháº£i cÃ³: `_id, first_name, last_name, full_name, email, phonenumber, status, orders_count?, createdAt` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetCustomersController` âœ…

- [x] **GET /admin/customers/:id** âœ…
  - [x] Response format: `{ message, data: User }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetCustomerDetailController` âœ…

- [x] **PUT /admin/customers/:id/status** âœ…
  - [x] Response format: `{ message }` âœ…
  - [x] Request body: `{ status: 'active' | 'inactive' }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateCustomerStatusController` âœ…

### Step 5: Admin Settings
- [x] **GET /admin/settings** âœ…
  - [x] Response format: `{ message, data: { general: { store_name, store_email, store_phone, store_address, logo_url }, payment?: {...}, shipping?: {...} } }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminGetSettingsController` âœ…

- [x] **PUT /admin/settings/general** âœ…
  - [x] Response format: `{ message }` hoáº·c `{ message, data: Settings }` âœ…
  - [x] Request body: `{ store_name?, store_email?, store_phone?, store_address? }` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateSettingsGeneralController` âœ…

- [x] **POST /admin/settings/logo** âœ…
  - [x] Response format: `{ message, data: { logo_url: string } }` âœ…
  - [x] Request: multipart/form-data vá»›i field `logo` âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateSettingsLogoController` âœ…

- [x] **PUT /admin/settings/payment** âœ…
  - [x] Response format: `{ message }` âœ…
  - [x] Request body: Payment settings object âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateSettingsPaymentController` âœ…

- [x] **PUT /admin/settings/shipping** âœ…
  - [x] Response format: `{ message }` âœ…
  - [x] Request body: Shipping settings object âœ…
  - [x] Kiá»ƒm tra `admin.controller.ts` - `adminUpdateSettingsShippingController` âœ…

**Notes:**
- âœ… Táº¥t cáº£ response formats Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a Ä‘á»ƒ match vá»›i frontend expectations
- âœ… Dashboard stats: `{ total_revenue, total_orders, total_customers, total_products }`
- âœ… Revenue chart: `Array<{ date, revenue, orders }>`
- âœ… Stats overview: `{ today, this_week, this_month, this_year }` vá»›i DashboardStats format
- âœ… Products/Orders/Customers: `{ products/orders/customers: [], pagination: { page, limit, total_page, total } }`
- âœ… Order stats: `{ pending, processing, shipping, completed, cancelled, total }`
- âœ… Táº¥t cáº£ `_id` fields Ä‘Ã£ Ä‘Æ°á»£c convert sang string

---

## ğŸ“§ Phase 8: Contact API âœ…

### Step 1: Contact Form
- [x] **POST /contact/submit** âœ…
  - [x] Response format: `{ message, data: { id, name, email, created_at } }` âœ…
  - [x] Request body: `{ name, email, message, phone?, subject? }` âœ…
  - [x] Email gá»­i async (khÃ´ng block response) âœ…
  - [x] Timeout handling âœ…
  - [x] Kiá»ƒm tra `contact.controller.ts` - `submitContactController` âœ…

**Notes:**
- âœ… Backend tráº£ vá» `{ message, data: { id, name, email, created_at } }`
- âœ… Frontend `ContactRequest` interface Ä‘Ã£ cÃ³ `phone?` vÃ  `subject?`
- âœ… Email Ä‘Æ°á»£c gá»­i async, khÃ´ng block response
- âœ… Validation middleware Ä‘Ã£ Ä‘Æ°á»£c setup vá»›i express-validator

---

## ğŸ”§ Phase 9: Technical Improvements âœ…

### Step 1: Error Handling
- [x] **Standardize Error Responses** âœ…
  - [x] Táº¥t cáº£ errors tráº£ vá» format: `{ message: string, errors?: Array<{ field: string, message: string }> }` âœ…
  - [x] HTTP status codes Ä‘Ãºng: 400 (Bad Request), 401 (Unauthorized), 403 (Forbidden), 404 (Not Found), 500 (Internal Server Error) âœ…
  - [x] Kiá»ƒm tra `errors.middleware.ts` âœ…

### Step 2: CORS Configuration
- [x] **CORS Setup** - âœ… ÄÃ£ fix
  - [x] CÃ i Ä‘áº·t `cors` package
  - [x] Configure CORS trong `index.ts`
  - [x] Allow origin: `http://localhost:5173`
  - [x] Allow credentials: true
  - [x] Allow methods: GET, POST, PUT, DELETE, PATCH, OPTIONS
  - [x] Allow headers: Content-Type, Authorization

### Step 3: Request/Response Validation
- [x] **Request Validation** âœ…
  - [x] Táº¥t cáº£ POST/PUT requests cÃ³ validation middleware âœ…
  - [x] Sá»­ dá»¥ng `express-validator` âœ…
  - [x] Tráº£ vá» validation errors vá»›i format: `{ message, errors: Array<{ field, message }> }` âœ…
  - [x] ThÃªm validation cho checkout routes (validateShipping, placeOrder) âœ…
  - [x] ThÃªm validation cho admin routes (updateProduct, updateCustomerStatus, updateSettings) âœ…

- [x] **Response Validation** âœ…
  - [x] Äáº£m báº£o táº¥t cáº£ responses cÃ³ Ä‘Ãºng format âœ…
  - [x] TypeScript types cho request/response (Ä‘Ã£ cÃ³ trong codebase) âœ…

### Step 4: Performance & Optimization âœ…
- [x] **Database Queries** âœ…
  - [x] Optimize queries vá»›i indexes âœ…
    - [x] Users: email (unique), role âœ…
    - [x] Refresh tokens: token (unique), user_id, created_at (TTL) âœ…
    - [x] Categories: slug (unique), is_featured âœ…
    - [x] Products: slug (unique), category, status, is_featured, price, rating, created_at, text search âœ…
    - [x] Carts: user_id (unique) âœ…
    - [x] Orders: user_id, order_code (unique), status, created_at, compound (user_id + created_at) âœ…
    - [x] Contacts: email, created_at âœ…
  - [x] Sá»­ dá»¥ng pagination cho táº¥t cáº£ list endpoints âœ… (Ä‘Ã£ cÃ³ sáºµn trong products, orders, admin endpoints)
  - [x] Populate related data hiá»‡u quáº£ (khÃ´ng N+1 queries) âœ… (sá»­ dá»¥ng aggregation pipeline)

- [ ] **Caching** (Optional - cÃ³ thá»ƒ implement sau náº¿u cáº§n)
  - [ ] Cache cho categories, banners (náº¿u Ã­t thay Ä‘á»•i)
  - [ ] Cache headers cho static data

### Step 5: API Documentation âœ…
- [x] **OpenAPI/Swagger** âœ…
  - [x] Update OpenAPI specs trong `src/docs/openapi/` âœ…
    - [x] Auth endpoints (register, login, logout, refresh-token, social-login, forgot-password, reset-password, me, me/avatar) âœ…
    - [x] Contact endpoint (submit) âœ…
  - [x] Äáº£m báº£o táº¥t cáº£ endpoints cÃ³ documentation âœ…
  - [x] Test API docs táº¡i `/api-docs` âœ… (Ä‘Ã£ cÃ³ sáºµn endpoint)

---

## ğŸ“‹ Phase 10: Data Model Alignment âœ…

### Step 1: User Model
- [x] **User Schema** âœ…
  - [x] Äáº£m báº£o cÃ³ fields: `_id, first_name, last_name, full_name, email, password, role, avatar, address, phonenumber, date_of_birth, createdAt, updatedAt` âœ…
  - [x] Role enum: `'customer' | 'admin' | 'staff'` âœ… (cÃ³ thÃªm staff role)
  - [x] Kiá»ƒm tra `Users.schema.ts` âœ…

### Step 2: Product Model
- [x] **Product Schema** âœ…
  - [x] Äáº£m báº£o cÃ³ fields: `_id, name, slug, description, price, price_before_discount, images, image, sizes, colors, quantity, rating, category, status, is_featured, createdAt, updatedAt` âœ…
  - [x] Status enum: `'active' | 'inactive' | 'out_of_stock' | 'low_stock' | 'draft'` âœ…
  - [x] Kiá»ƒm tra `Product.schema.ts` âœ…

### Step 3: Order Model
- [x] **Order Schema** âœ…
  - [x] Äáº£m báº£o cÃ³ fields: `_id, order_code, user_id, status, shipping_info, items, cost_summary, note, createdAt, updatedAt` âœ…
  - [x] Status enum: `'pending' | 'processing' | 'shipping' | 'completed' | 'cancelled'` âœ…
  - [x] Shipping info: `{ receiver_name, phone, email, address, payment_method, estimated_delivery }` âœ…
  - [x] Cost summary: `{ subtotal, shipping_fee, discount_amount, total }` âœ…
  - [x] Kiá»ƒm tra `Order.schema.ts` âœ…
  - [x] Cáº­p nháº­t `orders.services.ts` Ä‘á»ƒ thÃªm `note` field âœ…

### Step 4: Cart Model
- [x] **Cart Schema** âœ…
  - [x] Äáº£m báº£o cÃ³ fields: `_id, user_id, items, created_at, updated_at` âœ…
  - [x] CartItem: `{ _id, product_id, buy_count, color?, size? }` âœ…
  - [x] Kiá»ƒm tra `Cart.schema.ts` âœ…

---

## ğŸ§ª Phase 11: Testing & Verification âœ…

### Step 1: API Endpoint Testing
- [x] **Test checklist document created** âœ…
  - [x] Created `be/TEST_CHECKLIST.md` vá»›i comprehensive test checklist âœ…
  - [x] Covers táº¥t cáº£ endpoints: Auth, User, Products, Cart, Checkout, Orders, Admin, Contact âœ…
  - [x] Includes test cases cho success vÃ  error scenarios âœ…
  - [ ] Manual testing vá»›i Postman/Thunder Client (cáº§n user test)

### Step 2: Response Format Verification
- [x] **Response format verification utility created** âœ…
  - [x] Created `be/src/utils/verify-response-format.ts` âœ…
  - [x] Utility functions Ä‘á»ƒ verify response formats âœ…
  - [x] Test script Ä‘á»ƒ verify pagination format âœ…
  - [x] Táº¥t cáº£ success responses cÃ³ `{ message, data }` âœ… (Ä‘Ã£ verify trong code)
  - [x] Táº¥t cáº£ error responses cÃ³ `{ message, errors? }` âœ… (Ä‘Ã£ verify trong errors.middleware.ts)
  - [x] Pagination format nháº¥t quÃ¡n âœ… (Ä‘Ã£ verify trong services)
  - [x] Data types Ä‘Ãºng âœ… (TypeScript types Ä‘áº£m báº£o)

### Step 3: Frontend Integration Testing
- [x] **Frontend integration test checklist created** âœ…
  - [x] Test checklist cho Login/Register flow âœ…
  - [x] Test checklist cho Product listing vÃ  detail âœ…
  - [x] Test checklist cho Add to cart âœ…
  - [x] Test checklist cho Checkout flow âœ…
  - [x] Test checklist cho Order history âœ…
  - [x] Test checklist cho Admin dashboard âœ…
  - [ ] Manual testing (cáº§n user test)

---

## ğŸ“ Phase 12: Seed Data

### Step 1: Categories Seed Data
- [ ] **Tham kháº£o UI vÃ  cáº­p nháº­t categories seed**
  - [ ] Kiá»ƒm tra `ui/categories.html` vÃ  `ui/trangchu.html` Ä‘á»ƒ láº¥y category data
  - [ ] Äáº£m báº£o cÃ³ Ä‘á»§ categories: Ão, Quáº§n, Ão khoÃ¡c (vÃ  cÃ³ thá»ƒ thÃªm: Äá»“ Len & Dá»‡t Kim, Denim Tá»‘i Giáº£n, Phá»¥ Kiá»‡n)
  - [ ] Má»—i category pháº£i cÃ³: `name, slug, image, description, is_featured`
  - [ ] Images pháº£i match vá»›i UI (láº¥y tá»« HTML)
  - [ ] Update `be/src/utils/seed.ts` - categories array

### Step 2: Products Seed Data âœ…
- [x] **Tham kháº£o UI vÃ  cáº­p nháº­t products seed** âœ…
  - [x] Kiá»ƒm tra `ui/trangchu.html`, `ui/product.html`, `ui/categories.html` Ä‘á»ƒ láº¥y product data âœ…
  - [x] **Products tá»« UI Ä‘Ã£ thÃªm vÃ o seed:** âœ…
    - [x] Ão sÆ¡ mi Linen (850.000Ä‘) - Beige/Tráº¯ng - Featured âœ…
    - [x] Quáº§n á»‘ng rá»™ng Taki (650.000Ä‘) - XÃ¡m khÃ³i âœ…
    - [x] VÃ¡y suÃ´ng Sumi (790.000Ä‘) - Äen tuyá»n âœ…
    - [x] Ão thun Cotton Basic (350.000Ä‘) - Tráº¯ng tinh khÃ´i âœ…
    - [x] Ão khoÃ¡c Blazer Kaki (950.000Ä‘) - Best Seller âœ…
    - [x] SÆ¡ mi lá»¥a Muji (720.000Ä‘) - Best Seller âœ…
    - [x] TÃºi Canvas YORI (250.000Ä‘) - Best Seller âœ…
    - [x] Quáº§n TÃ¢y Chinos (680.000Ä‘) - Best Seller âœ…
    - [x] Oversized Tee (450.000Ä‘) âœ…
    - [x] Casual Shorts (380.000Ä‘) âœ…
    - [x] Denim Jacket (890.000Ä‘) âœ…
  - [x] Má»—i product cÃ³ Ä‘áº§y Ä‘á»§ fields: âœ…
    - [x] `name, slug, image, images[]` âœ…
    - [x] `description` (fit type: Relaxed Fit, Oversized Fit, Regular Fit, Standard Fit, Slim Fit, Water Resistant) âœ…
    - [x] `category_slug` (match vá»›i categories) âœ…
    - [x] `price, price_before_discount` (náº¿u cÃ³ discount) âœ…
    - [x] `quantity, sold, view, rating` âœ…
    - [x] `colors[]` (match vá»›i UI: White, Beige, Blue, Black, Navy, Grey, etc.) âœ…
    - [x] `sizes[]` (S, M, L, XL, XXL hoáº·c 46, 48, 50, 52 cho Ã¡o khoÃ¡c) âœ…
    - [x] `is_featured` (true cho featured products) âœ…
    - [x] `status` (ProductStatus.Active) âœ…
  - [x] Images match vá»›i UI (láº¥y tá»« HTML background-image URLs) âœ…
  - [x] Update `be/src/utils/seed.ts` - products array âœ…

### Step 3: Banners Seed Data âœ…
- [x] **Táº¡o banners seed data** âœ…
  - [x] Kiá»ƒm tra `ui/trangchu.html` Ä‘á»ƒ láº¥y hero banner data âœ…
  - [x] **Hero Banner tá»« UI:** âœ…
    - [x] Title: "Tinh tháº§n tá»‘i giáº£n\nVáº» Ä‘áº¹p bá»n vá»¯ng" âœ…
    - [x] Subtitle: "Phong cÃ¡ch Thu ÄÃ´ng 2024" âœ…
    - [x] Image URL: tá»« UI hero section âœ…
    - [x] CTA Text: "KhÃ¡m PhÃ¡ Ngay" âœ…
    - [x] CTA Link: "/products" âœ…
    - [x] Position: "home_hero" âœ…
  - [x] Táº¡o Banner schema/model (`be/src/models/schemas/Banner.schema.ts`) âœ…
  - [x] ThÃªm banners collection vÃ o `be/src/services/database.services.ts` âœ…
  - [x] Táº¡o seed function cho banners trong `be/src/utils/seed.ts` âœ…
  - [x] Äáº£m báº£o banners Ä‘Æ°á»£c seed vÃ o database âœ…

### Step 4: Users Seed Data (Admin & Test Users) âœ…
- [x] **Táº¡o admin user seed** âœ…
  - [x] Táº¡o 1 admin user vá»›i: âœ…
    - [x] `first_name: "Admin"` âœ…
    - [x] `last_name: "YORI"` âœ…
    - [x] `email: "admin@yori.com"` (hoáº·c tá»« env) âœ…
    - [x] `password: "admin123"` (hash vá»›i bcrypt) âœ…
    - [x] `role: "admin"` âœ…
    - [x] `verify: "verified"` âœ…
  - [x] Táº¡o 3 test customer users: âœ…
    - [x] Customer 1: `email: "customer1@test.com"`, `password: "123456"` âœ…
    - [x] Customer 2: `email: "customer2@test.com"`, `password: "123456"` âœ…
    - [x] Customer 3: `email: "customer3@test.com"`, `password: "123456"` âœ…
  - [x] Táº¥t cáº£ users cÃ³ Ä‘áº§y Ä‘á»§ fields: `first_name, last_name, full_name, email, password (hashed), role, verify, createdAt, updatedAt` âœ…
  - [x] Táº¡o seed function cho users trong `be/src/utils/seed.ts` âœ…

### Step 5: Seed Script Enhancement âœ…
- [x] **Cáº£i thiá»‡n seed script** âœ…
  - [x] KhÃ´ng xÃ³a products má»—i láº§n cháº¡y (chá»‰ seed náº¿u chÆ°a cÃ³) âœ…
  - [x] Check existing data trÆ°á»›c khi seed (giá»‘ng categories) âœ…
  - [x] Log rÃµ rÃ ng: "Seeding categories...", "Seeding products...", "Seeding banners...", "Seeding users..." âœ…
  - [x] Handle errors gracefully âœ…
  - [x] TÃ¡ch thÃ nh cÃ¡c functions riÃªng: `seedCategories()`, `seedProducts()`, `seedBanners()`, `seedUsers()` âœ…
  - [x] CÃ³ thá»ƒ export cÃ¡c functions Ä‘á»ƒ cháº¡y riÃªng tá»«ng pháº§n âœ…
  - [x] Cháº¡y táº¥t cáº£: `npm run seed` hoáº·c `npx ts-node be/src/utils/seed.ts` âœ…

### Step 6: Seed Data Validation âœ…
- [x] **Validate seed data** âœ…
  - [x] Táº¡o validation functions trong `be/src/utils/validate-seed-data.ts` âœ…
  - [x] Táº¥t cáº£ products pháº£i cÃ³ category há»£p lá»‡ âœ…
  - [x] Táº¥t cáº£ slugs pháº£i unique vÃ  URL-friendly âœ…
  - [x] Prices pháº£i lÃ  sá»‘ dÆ°Æ¡ng âœ…
  - [x] Images URLs pháº£i cÃ³ format há»£p lá»‡ (http/https) âœ…
  - [x] Colors vÃ  sizes arrays khÃ´ng Ä‘Æ°á»£c empty âœ…
  - [x] Ratings pháº£i trong khoáº£ng 0-5 âœ…
  - [x] TÃ­ch há»£p validation vÃ o seed script âœ…
  - [x] Test seed script vÃ  verify data trong database âœ…

### Step 7: Seed Data Documentation âœ…
- [x] **Document seed data** âœ…
  - [x] Comment trong seed file giáº£i thÃ­ch nguá»“n data (UI files) âœ…
  - [x] Document cÃ¡ch cháº¡y seed script âœ…
  - [x] Document default admin credentials âœ…
  - [x] Document test user credentials âœ…
  - [x] Note vá» viá»‡c seed data Ä‘Æ°á»£c láº¥y tá»« UI files âœ…
  - [x] Táº¡o file `be/SEED_DATA.md` vá»›i documentation Ä‘áº§y Ä‘á»§ âœ…

---

## ğŸ“ Phase 13: Documentation âœ…

### Step 1: API Documentation âœ…
- [x] **Update API Documentation** âœ…
  - [x] OpenAPI specs Ä‘Ã£ cÃ³ trong `be/src/docs/openapi/` âœ…
  - [x] Táº¡o file `be/API_DOCUMENTATION.md` vá»›i documentation Ä‘áº§y Ä‘á»§ âœ…
  - [x] Document táº¥t cáº£ endpoints (Auth, Products, Cart, Checkout, Orders, Contact, Admin) âœ…
  - [x] Document request/response formats âœ…
  - [x] Document error codes vÃ  messages âœ…
  - [x] Document authentication flow âœ…
  - [x] Document pagination format âœ…

### Step 2: Environment Variables âœ…
- [x] **Document Environment Variables** âœ…
  - [x] Táº¡o file `.env.example` vá»›i táº¥t cáº£ environment variables âœ…
  - [x] Táº¡o file `be/ENVIRONMENT_VARIABLES.md` vá»›i documentation Ä‘áº§y Ä‘á»§ âœ…
  - [x] Document Database connection (DB_USERNAME, DB_PASSWORD, DB_NAME, collections) âœ…
  - [x] Document JWT secrets (JWT_SECRET, ACCESS_TOKEN_EXPIRE_IN, REFRESH_TOKEN_EXPIRE_IN, FORGOT_PASSWORD_TOKEN_EXPIRE_IN) âœ…
  - [x] Document SMTP config (SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS) âœ…
  - [x] Document CORS origin (FRONTEND_URL) âœ…
  - [x] Document Port configuration (PORT) âœ…
  - [x] Document Admin credentials (ADMIN_EMAIL, ADMIN_PASSWORD) âœ…
  - [x] Include setup instructions vÃ  security best practices âœ…

### Step 3: Seed Data Documentation âœ…
- [x] **Document Seed Data** âœ… (ÄÃ£ hoÃ n thÃ nh á»Ÿ Step 7 Phase 12)
  - [x] Document cÃ¡ch cháº¡y seed script âœ…
  - [x] Document default admin credentials âœ…
  - [x] Document test user credentials âœ…
  - [x] Note vá» nguá»“n seed data (UI files) âœ…
  - [x] File `be/SEED_DATA.md` Ä‘Ã£ Ä‘Æ°á»£c táº¡o âœ…

---

## âœ… Priority Checklist (Must Fix First)

### High Priority âœ…
1. [x] **Add `/users/me` endpoint** - Frontend cáº§n Ä‘á»ƒ load user profile âœ…
2. [x] **Add `/users/me` PATCH endpoint** - Frontend cáº§n Ä‘á»ƒ update profile âœ…
3. [x] **Add `/users/me/avatar` POST endpoint** - Frontend cáº§n Ä‘á»ƒ upload avatar âœ…
4. [x] **Standardize cart response** - Äá»•i `result` â†’ `data` trong cart controller âœ…
5. [x] **Standardize checkout place-order response** - Äá»•i `result` â†’ `data` âœ…
6. [x] **Standardize locations response** - Äá»•i `result` â†’ `data` âœ…
7. [x] **Update seed data** - ThÃªm products, categories, banners tá»« UI Ä‘á»ƒ frontend cÃ³ data Ä‘á»ƒ test âœ…

### Medium Priority âœ…
8. [x] **Populate product info trong cart items** - Frontend cáº§n product_name, product_image, price trong cart items âœ… (ÄÃ£ implement trong `cart.services.ts` - getCart method sá»­ dá»¥ng $lookup Ä‘á»ƒ populate product info)
9. [x] **Standardize táº¥t cáº£ response formats** - Äáº£m báº£o `{ message, data }` nháº¥t quÃ¡n âœ…
10. [x] **Verify pagination format** - Äáº£m báº£o cÃ³ `page, limit, total_page, total` âœ…
11. [x] **Verify order response format** - Äáº£m báº£o cÃ³ Ä‘áº§y Ä‘á»§ fields âœ…

### Low Priority
11. [ ] **Optimize database queries** - ÄÃ£ cÃ³ indexes trong `db-indexes.ts`
12. [ ] **Add caching** (náº¿u cáº§n) - Redis hoáº·c in-memory cache
13. [x] **Update API documentation** âœ… - ÄÃ£ táº¡o `API_DOCUMENTATION.md`
14. [x] **Enhance seed script** âœ… - ÄÃ£ tÃ¡ch thÃ nh cÃ¡c functions riÃªng (seedCategories, seedProducts, seedBanners, seedUsers)
15. [x] **Create README.md** âœ… - ÄÃ£ táº¡o `be/README.md` vá»›i project overview

---

## ğŸ“Œ Notes

- Check off tá»«ng item khi hoÃ n thÃ nh
- Test sau má»—i thay Ä‘á»•i Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng break existing functionality
- Update frontend constants náº¿u backend routes thay Ä‘á»•i
- Äáº£m báº£o backward compatibility náº¿u cÃ³ thá»ƒ
- Review code trÆ°á»›c khi commit

---

## ğŸ”„ Migration Strategy

1. **Phase 1-2**: Fix critical missing endpoints (users/me, etc.)
2. **Phase 3-6**: Standardize response formats
3. **Phase 7-8**: Verify admin vÃ  contact APIs
4. **Phase 9-10**: Technical improvements vÃ  data model alignment
5. **Phase 11**: Testing
6. **Phase 12**: Seed data - ThÃªm products, categories, banners, users tá»« UI
7. **Phase 13**: Documentation

## ğŸ“‹ Seed Data Reference (from UI)

### Categories tá»« UI:
- **Ão** (slug: `ao`): "Cotton thoÃ¡ng mÃ¡t cho má»i ngÃ y"
- **Quáº§n** (slug: `quan`): "Kiá»ƒu dÃ¡ng vá»«a váº·n, tá»‘i giáº£n"
- **Ão khoÃ¡c** (slug: `ao-khoac`): "Lá»›p báº£o vá»‡ phong cÃ¡ch"
- **Äá»“ Len & Dá»‡t Kim** (cÃ³ thá»ƒ thÃªm)
- **Denim Tá»‘i Giáº£n** (cÃ³ thá»ƒ thÃªm)
- **Phá»¥ Kiá»‡n** (cÃ³ thá»ƒ thÃªm)

### Products tá»« UI (cáº§n thÃªm vÃ o seed):
1. **Ão sÆ¡ mi Linen** - 850.000Ä‘ - Beige/Tráº¯ng - Featured
2. **Quáº§n á»‘ng rá»™ng Taki** - 650.000Ä‘ - XÃ¡m khÃ³i - New
3. **VÃ¡y suÃ´ng Sumi** - 790.000Ä‘ - Äen tuyá»n
4. **Ão thun Cotton Basic** - 350.000Ä‘ - Tráº¯ng tinh khÃ´i
5. **Ão khoÃ¡c Blazer Kaki** - 950.000Ä‘ - Best Seller
6. **SÆ¡ mi lá»¥a Muji** - 720.000Ä‘ - Best Seller
7. **TÃºi Canvas YORI** - 250.000Ä‘ - Best Seller
8. **Quáº§n TÃ¢y Chinos** - 680.000Ä‘ - Best Seller
9. **Oversized Tee** - 450.000Ä‘ - New
10. **Casual Shorts** - 380.000Ä‘
11. **Denim Jacket** - 890.000Ä‘
12. **Black Polo** - (tá»« UI)

### Banners tá»« UI:
- **Hero Banner**: "Tinh tháº§n tá»‘i giáº£n\nVáº» Ä‘áº¹p bá»n vá»¯ng" - "Phong cÃ¡ch Thu ÄÃ´ng 2024" - Position: `home_hero`

---

*Last Updated: [Date]*

